
# ==========================================
# 1. 온열질환 및 벌레물림
# ==========================================

HEAT_ILLNESS_GUIDE = """
## 온열질환 응급처치

### 열사병 (Heat Stroke) - 가장 위험! 사망 가능
**증상**
- 40도 이상 고열
- 땀이 나지 않음 (체온 조절 실패)
- 피부가 뜨겁고 건조하며 붉은색
- 혼란, 의식 저하, 경련

**응급처치**
1. 즉시 119 신고
2. 시원한 장소로 이동 (에어컨 있는 곳)
3. 체온 낮추기 (핵심!)
   - 시원한 물수건으로 몸 닦기
   - 얼음주머니를 목/겨드랑이/사타구니에 대기
   - 부채질 하기
4. ⚠️ 물/음식 먹이지 말 것 (질식 위험)

### 열탈진/일사병 (Heat Exhaustion)
**증상**
- 체온 37~40도
- 땀을 과도하게 많이 흘림
- 피부가 차갑고 축축하며 창백
- 두통, 어지럼, 구토

**응급처치**
1. 시원한 장소로 이동
2. 옷 느슨하게, 휴식
3. 소금 든 찬물 또는 이온 음료 섭취
4. 30분 내 회복 안되면 병원 방문

### 벌에 쏘였을 때
**응급처치**
1. 벌침 제거: 신용카드로 긁어내듯이 (핀셋 사용 금지!)
2. 환자 안정시키기 (독이 퍼지지 않게)
3. 깨끗한 물로 씻고 냉찜질
4. 알레르기 반응 시 즉시 병원 (호흡곤란, 두드러기)
"""


# ==========================================
# 2. 화상 및 출혈
# ==========================================

BURN_BLEEDING_GUIDE = """
## 화상 응급처치

### 화상 정도 분류
- 1도: 표피만, 빨갛게, 물집 없음 (2-3일 치유)
- 2도: 진피까지, 물집, 심한 통증 (1-2주 치유)
- 3도: 전층 손상, 하얗거나 검게, 즉시 응급실!

### 화상 응급처치 (가장 중요!)
1. 미온수로 10-15분간 세척 (열기 제거!)
2. 의복 처리: 가위로 조심스럽게 잘라내기 (억지로 벗기지 말 것)
3. 물집 절대 터트리지 말 것
4. 깨끗한 천으로 덮기

### ⚠️ 절대 금지 사항
- 얼음 직접 대기 (동상 위험)
- 된장, 간장, 치약 바르기 (감염 위험!)
- 기름, 버터 바르기
- 억지로 옷 벗기기

## 출혈 응급처치

### 직접 압박법 (가장 효과적!)
1. 깨끗한 천/거즈로 덮기
2. 손으로 직접 세게 압박 (5-10분)
3. 거즈가 젖어도 떼지 말고 위에 추가
4. 붕대로 감기
5. 손상 부위를 심장보다 높게

### 코피 처치
1. 앉은 자세에서 고개 약간 앞으로 (뒤로 젖히면 안됨!)
2. 콧방울 5-10분간 꾹 누르기
3. 이마/코에 찬 수건

### 즉시 119 신고
- 출혈이 멈추지 않음
- 동맥 출혈 (밝은 빨간색, 분출)
- 절단 상처
- 쇼크 증상
"""


# ==========================================
# 3. 골절 및 염좌
# ==========================================

FRACTURE_SPRAIN_GUIDE = """
## 골절 응급처치

### 골절 증상
1. 심한 통증 (살짝 눌러도 아픔)
2. 부종 (붓기)
3. 변형 (좌우 비교 시 차이)
4. 기능 상실 (움직일 수 없음)
5. 개방성 골절: 뼈가 돌출 (감염 위험!)

### 응급처치 방법
1. 환자 움직이지 않기
2. 개방성 골절: 깨끗한 거즈로 압박 지혈
3. 부목으로 골절 부위 고정
4. 냉찜질 (얼음을 천으로 싸서)
5. 쇼크 예방 (따뜻하게 유지)

### ⚠️ 절대 금지
- 골절 부위 움직이기
- 뼈 원위치로 돌리기
- 척추 골절 의심 시 함부로 움직이기

## 염좌 (삠) - RICE 원칙

- **R**est (휴식): 움직이지 않기
- **I**ce (냉찜질): 20분 냉찜질, 20분 휴식 반복
- **C**ompression (압박): 탄력붕대로 가볍게
- **E**levation (거상): 심장보다 높게
"""


# ==========================================
# 4. 소아 발열 관리
# ==========================================

CHILD_FEVER_GUIDE = """
## 소아 발열 관리

### 발열 기준
- 3세 미만: 직장온도 38도 이상
- 3세 이상: 구강온도 37.2도 이상
- 신생아: 겨드랑이 37.4도 이상

### 해열제 사용 시기
- 체온 38도 이상 + 아이가 힘들어할 때
- 기저질환 있는 경우
- 열성 경련 경험 있는 아이

### 소아 해열제 종류

**1. 아세트아미노펜 (타이레놀)**
- 용량: 10-15mg/kg/회
- 간격: 4시간
- 연령: 생후 4개월 이상
- 특징: 빈속 복용 가능

**2. 이부프로펜 (부루펜)**
- 용량: 5-10mg/kg/회
- 간격: 6시간
- 연령: 생후 6개월 이상
- 특징: 항염증 효과

### ⚠️ 주의사항
- 아스피린 절대 금지 (라이 증후군!)
- 복용 간격 꼭 지키기
- 체중에 맞춰 용량 계산
- 성인용 쪼개서 먹이지 말기

### 즉시 병원 (응급실)
- 생후 3개월 미만 38도 이상 발열
- 경련/발작
- 의식 저하
- 호흡곤란
- 열이 4-5일 지속
"""


# ==========================================
# 5. 소아 폐렴
# ==========================================

CHILD_PNEUMONIA_GUIDE = """
## 소아 폐렴

### 주요 원인
1. **바이러스 폐렴** (가장 흔함)
   - RSV, 아데노바이러스, 인플루엔자
   - 3-7일 후 저절로 낫는 경우 많음

2. **마이코플라스마 폐렴** (학령기)
   - 5-9세: 33%
   - 9-15세: 70%
   - 매 3-4년마다 대유행

3. **세균 폐렴**
   - 폐렴구균, 포도상구균, 인플루엔자균
   - 항생제 치료 필요

### 주요 증상
- 가래와 기침
- 빠른 호흡
- 가슴 통증, 호흡곤란
- 고열 (최대 40도)
- 쌕쌕거림 (비정형폐렴)

### 치료
- **바이러스**: 휴식, 수분 섭취 (3-7일 후 자연 치유)
- **세균**: 항생제 (3일 내 열 떨어짐)
- 수분 충분히, 머리 높여주기

### 즉시 진료 필요
- 호흡곤란
- 39도 이상 고열
- 기침이 거칠고 지속
- 힘들어 보임
"""


# ==========================================
# 6. 소아 심폐소생술
# ==========================================

CHILD_CPR_GUIDE = """
## 소아 심폐소생술 (5단계)

### 1단계: 심정지 확인
- 소아: 어깨 흔들며 반응 확인
- 영아(1세 미만): 발바닥 때리기
- 반응 없으면 119 신고 + 자동심장충격기 요청

### 2단계: 가슴압박 30회 (소아)
- 위치: 양쪽 젖꼭지 선 정중앙 바로 아래
- 방법: 한 손 손바닥으로
- 속도: 100-120회/분
- 깊이: 4-5cm
- 30회 실시

### 3단계: 영아 가슴압박 (1세 미만)
- 위치: 동일
- 방법: 검지+중지 두 손가락
- 속도: 100-120회/분
- 깊이: 4cm
- 30회 실시

### 4단계: 인공호흡 2회
- 소아: 입 대 입
- 영아: 입으로 입과 코 막고
- 1초간 불기
- 가슴 올라오는지 확인

### 5단계: 반복
- 가슴압박 30회 + 인공호흡 2회
- 119 도착까지 반복

## 기도폐쇄 (이물질)

### 소아/성인: 하임리히법
1. 환자 등 뒤에서 주먹 쥐기
2. 배꼽-명치 사이에 주먹 대기
3. 위로 강하게 밀어올리기

### 영아: 등 두드리기
1. 얼굴 아래로, 무릎에 올리기
2. 등 중심부 손바닥으로 5회
3. 앞으로 뒤집기
"""


# ==========================================
# 전체 지식 통합 딕셔너리
# ==========================================

MEDICAL_KNOWLEDGE_BASE = {
    "온열질환_벌레물림": HEAT_ILLNESS_GUIDE,
    "화상_출혈": BURN_BLEEDING_GUIDE,
    "골절_염좌": FRACTURE_SPRAIN_GUIDE,
    "소아_발열": CHILD_FEVER_GUIDE,
    "소아_폐렴": CHILD_PNEUMONIA_GUIDE,
    "소아_심폐소생술": CHILD_CPR_GUIDE,
}


def get_relevant_knowledge(query: str) -> str:
    """
    간단한 키워드 매칭으로 관련 지식 반환
    """
    query_lower = query.lower().replace(" ", "")
    
    relevant_sections = []
    
    # 키워드 기반 매칭
    if any(k in query_lower for k in ["열사병", "일사병", "온열", "더위", "벌"]):
        relevant_sections.append(HEAT_ILLNESS_GUIDE)
    
    if any(k in query_lower for k in ["화상", "데였", "출혈", "피", "코피"]):
        relevant_sections.append(BURN_BLEEDING_GUIDE)
    
    if any(k in query_lower for k in ["골절", "부러", "삠", "염좌", "뼈"]):
        relevant_sections.append(FRACTURE_SPRAIN_GUIDE)
    
    if any(k in query_lower for k in ["열", "발열", "고열", "해열제", "타이레놀"]):
        relevant_sections.append(CHILD_FEVER_GUIDE)
    
    if any(k in query_lower for k in ["폐렴", "기침", "가래", "호흡곤란"]):
        relevant_sections.append(CHILD_PNEUMONIA_GUIDE)
    
    if any(k in query_lower for k in ["심폐소생", "cpr", "의식없", "경련", "기도폐쇄"]):
        relevant_sections.append(CHILD_CPR_GUIDE)
    
    if relevant_sections:
        return "\n\n".join(relevant_sections)
    else:
        # 기본: 모든 지식 요약본
        return """
관련 정보를 찾지 못했습니다. 
증상을 더 구체적으로 설명해주시면 도움을 드릴 수 있습니다.

예: "아이가 열이 39도예요", "화상 입었어요", "골절 의심돼요"
"""
